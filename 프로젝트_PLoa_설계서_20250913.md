# 프로젝트_PLoa_설계서_20250913

## 📋 프로젝트 개요

### 1.1 프로젝트 목적
PLoa는 로스트아크 게임 데이터를 분석하고 활용하는 웹 애플리케이션으로, 유저의 효율적인 게임 플레이를 지원하는 종합 분석 플랫폼입니다.

### 1.2 주요 기능
- **캐릭터 분석**: 장비, 각인, 보석, 스킬 등 상세 정보 제공
- **시세 분석**: 실시간 거래소 가격 정보 및 트렌드 분석
- **효율 계산**: 레이드 더보기 효율, 강화 비용 계산
- **스케줄 관리**: 캐릭터별 일일/주간 컨텐츠 관리
- **유틸리티**: 룰렛, 골드 계산기 등 편의 기능

### 1.3 기술 스택 개요
- **Frontend**: React 19.1.0 + Vite 5.4.0
- **Styling**: TailwindCSS 3.4.17 (라이트/다크 테마)
- **State Management**: React Hooks 기반
- **API Integration**: Lost Ark Open API
- **Development Environment**: WSL2 Ubuntu, Node.js v21.7.3

---

## 🏗 시스템 아키텍처

### 2.1 전체 아키텍처 구조

```
┌─────────────────────────────────────────────┐
│                 PLoa Frontend               │
│            (React + TailwindCSS)            │
├─────────────────────────────────────────────┤
│  Pages Layer                                │
│  ├── Dashboard                              │
│  ├── CharacterDetail                        │
│  ├── MarketPrice                            │
│  ├── Scheduler                              │
│  └── Utilities                              │
├─────────────────────────────────────────────┤
│  Components Layer                           │
│  ├── Common (Layout, UI)                    │
│  ├── Character (분석 컴포넌트)                 │
│  ├── Market (시세 컴포넌트)                    │
│  ├── Scheduler (스케줄 컴포넌트)               │
│  └── Utility (계산기 컴포넌트)                 │
├─────────────────────────────────────────────┤
│  Services & Utils Layer                     │
│  ├── Lost Ark API Service                  │
│  ├── 18개 전문 파서 모듈                      │
│  ├── Price Storage System                  │
│  └── Data Utilities                        │
├─────────────────────────────────────────────┤
│  Data Layer                                 │
│  ├── Static Game Data                      │
│  ├── Icons & Assets                        │
│  └── Configuration                         │
└─────────────────────────────────────────────┘
               ↕ HTTP API
┌─────────────────────────────────────────────┐
│             Express Proxy Server            │
│            (CORS 처리 및 API 중계)           │
└─────────────────────────────────────────────┘
               ↕ HTTPS API
┌─────────────────────────────────────────────┐
│          Lost Ark Open API                  │
│        (공식 게임 데이터 제공)                │
└─────────────────────────────────────────────┘
```

### 2.2 컴포넌트 구조도

```
src/
├── components/
│   ├── common/                    # 공통 컴포넌트
│   │   ├── LoadingSpinner.jsx     # 로딩 스피너
│   │   ├── ErrorMessage.jsx       # 에러 메시지
│   │   └── MaterialComponents.jsx # 재료 아이콘 컴포넌트
│   ├── character/                 # 캐릭터 관련 컴포넌트
│   │   ├── CollectiblesProgress.jsx
│   │   └── WeeklyGoldCalculator.jsx
│   ├── dashboard/                 # 대시보드 컴포넌트
│   │   ├── EventBanner.jsx
│   │   ├── NoticeSection.jsx
│   │   └── QuickStats.jsx
│   ├── layout/                    # 레이아웃 컴포넌트
│   │   └── Header.jsx
│   ├── scheduler/                 # 스케줄러 컴포넌트
│   │   └── CharacterCard.jsx
│   ├── ui/                        # UI 기본 컴포넌트
│   │   └── GradeTag.jsx
│   └── utility/                   # 유틸리티 컴포넌트
│       ├── EnhancementCalculator.jsx
│       ├── MoreRewardsCalculator.jsx
│       ├── RaidGateCard.jsx
│       ├── RaidSelectCard.jsx
│       └── TotalSummaryCard.jsx
```

### 2.3 API 연동 구조

```
Frontend Request → Express Proxy → Lost Ark API
                     ↓
                  Response Processing
                     ↓
                18개 전문 파서 모듈
                     ↓
                 State Management
                     ↓
               UI 컴포넌트 렌더링
```

### 2.4 데이터 흐름도

```
Lost Ark API Data → Raw JSON → 전문 파서 → Structured Data → UI Components
                                    ↓
                           Local Storage Cache
                                    ↓
                            Price Storage System
                                    ↓
                         Real-time UI Updates
```

---

## 🖥 화면 설계

### 3.1 주요 페이지 구성

#### 3.1.1 Dashboard (메인 대시보드)
- **경로**: `/`
- **주요 기능**:
  - 이벤트 배너 (EventBanner)
  - 공지사항 섹션 (NoticeSection) 
  - 빠른 통계 (QuickStats)
- **상태 관리**: 로컬 상태 기반
- **특징**: 진입점 역할, 다른 기능으로의 네비게이션 제공

#### 3.1.2 CharacterDetail (캐릭터 상세)
- **경로**: `/character/:characterName`
- **주요 기능**:
  - 4개 탭 구조: 기본정보, 장비, 각인/보석, 수집품
  - 실시간 API 데이터 조회
  - 상세 파싱 및 분석 정보 제공
- **상태 관리**: useApi 훅 활용
- **특징**: 18개 전문 파서 모듈 집중 활용

#### 3.1.3 MarketPrice (시세 검색)
- **경로**: `/market`
- **주요 기능**:
  - 아이템 검색 및 가격 조회
  - 가격 히스토리 차트
  - 실시간 시세 업데이트
- **상태 관리**: Price Storage System
- **특징**: 거래소 API 연동, 캐싱 시스템

#### 3.1.4 Scheduler (스케줄 관리)
- **경로**: `/scheduler`
- **주요 기능**:
  - 캐릭터별 일일/주간 컨텐츠 체크
  - 드래그 앤 드롭 캐릭터 정렬
  - 자동 리셋 시스템
- **상태 관리**: useScheduler 전용 훅
- **특징**: 복잡한 상태 관리, 로컬 스토리지 연동

#### 3.1.5 Utilities (유틸리티)
- **경로**: `/utilities`
- **주요 기능**:
  - 강화 계산기 (EnhancementCalculator)
  - 더보기 효율 계산기 (MoreRewardsCalculator)
  - 경매 계산기
  - 제비뽑기
- **상태 관리**: 각 컴포넌트별 독립적 관리
- **특징**: 사전 계산된 데이터 활용, 복잡한 수식 계산

### 3.2 사용자 플로우

```
메인 대시보드 (Dashboard)
    ├── 캐릭터 검색 → 캐릭터 상세 (CharacterDetail)
    │                   ├── 기본정보 탭
    │                   ├── 장비 탭
    │                   ├── 각인/보석 탭
    │                   └── 수집품 탭
    ├── 시세 검색 → 시세 분석 (MarketPrice)
    │                ├── 아이템 검색
    │                ├── 가격 히스토리
    │                └── 실시간 시세
    ├── 스케줄 관리 → 스케줄러 (Scheduler)
    │                 ├── 캐릭터 추가/관리
    │                 ├── 일일/주간 체크
    │                 └── 드래그 정렬
    └── 유틸리티 → 계산기 모음 (Utilities)
                     ├── 강화 계산기
                     ├── 더보기 효율
                     ├── 경매 계산기
                     └── 제비뽑기
```

### 3.3 UI/UX 설계 원칙

#### 3.3.1 테마 시스템
```javascript
// 아이템 등급별 색상 (GRADE_COLORS)
에스더: 'text-cyan-400'
고대: 'text-gray-900 dark:text-white' 
유물: 'text-orange-400'
전설: 'text-yellow-400'
영웅: 'text-purple-400'
희귀: 'text-blue-400'
고급: 'text-green-400'
일반: 'text-gray-600 dark:text-gray-400'
```

#### 3.3.2 반응형 디자인
- **Breakpoints**: Tailwind 기본 설정 활용
- **Grid System**: 1/2/3/4 컬럼 자동 조정
- **Mobile First**: 모바일 우선 설계
- **Touch Friendly**: 터치 기기 최적화

#### 3.3.3 레이아웃 패턴
- **카드 기반**: `bg-white dark:bg-gray-800 rounded-lg border`
- **탭 인터페이스**: 상세 정보 표시
- **모달/드롭다운**: 추가 정보 표시
- **로딩 상태**: 스피너 애니메이션

---

## 📊 데이터 구조 설계

### 4.1 로스트아크 API 데이터 구조

#### 4.1.1 캐릭터 기본 정보
```javascript
// /armories/characters/{characterName}
{
  CharacterName: "캐릭터명",
  CharacterClassName: "직업명", 
  CharacterLevel: 60,
  ItemAvgLevel: "1620.00",
  ServerName: "서버명"
}
```

#### 4.1.2 캐릭터 장비 정보
```javascript
// /armories/characters/{characterName}/equipment
[
  {
    Type: "투구|어깨|상의|하의|장갑|무기",
    Name: "장비명 +25",
    Icon: "아이콘URL",
    Grade: "고대|유물|전설|영웅|희귀",
    Tooltip: "HTML형태의 상세정보"
  }
]
```

#### 4.1.3 수집품 진행도
```javascript
// /armories/characters/{characterName}/collectibles
[
  {
    Type: "모코코 씨앗",
    Icon: "아이콘URL", 
    Point: 1200,
    MaxPoint: 1209,
    CollectiblePoints: [
      {
        PointName: "루테란 동부",
        Point: 85,
        MaxPoint: 85
      }
    ]
  }
]
```

### 4.2 18개 전문 파서 모듈

#### 4.2.1 장비 파서 (equipmentParsers.js)
```javascript
// 재련 수치 파싱
export const getRefiningLevel = (tooltip) => {
  // HTML 툴팁에서 재련 단계 추출
  // 정규표현식으로 패턴 매칭
}

// 초월 수치 파싱  
export const getTranscendenceLevel = (tooltip) => {
  // 초월 단계 및 수치 파싱
}

// 품질 수치 파싱
export const getQuality = (tooltip) => {
  // 품질 퍼센트 추출
}
```

#### 4.2.2 팔찌 파서 (braceletParsers.js)
```javascript
// 이중 옵션 파싱
export const parseBraceletOptions = (tooltip) => {
  // 팔찌 특수 옵션 파싱
  // 치명타 적중시, 특수 효과 등
}
```

#### 4.2.3 보석 파서 (gemParsers.js)
```javascript
// 보석 효과 요약
export const parseGemEffects = (tooltip) => {
  // 멸화, 홍염 보석 효과 파싱
  // 스킬별 효과 분류
}
```

#### 4.2.4 장신구 단축 파서 (accessoryShortener.js)
```javascript
// 연마 효과 축약
export const shortenAccessoryEffects = (tooltip) => {
  // 긴 연마 효과명을 축약형으로 변환
  // 예: "적에게 주는 피해" → "적주피"
}
```

### 4.3 상태 관리 구조

#### 4.3.1 전역 상태
- **테마**: localStorage 기반 다크/라이트 모드
- **API 캐시**: 캐릭터 검색 히스토리
- **가격 데이터**: Price Storage System

#### 4.3.2 컴포넌트별 상태
```javascript
// useApi 훅 (공통 API 상태)
const useApi = (apiCall, dependencies) => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState(null);
  // ...
};

// useScheduler 훅 (스케줄러 전용)
const useScheduler = () => {
  const [characters, setCharacters] = useState([]);
  const [draggedCharacter, setDraggedCharacter] = useState(null);
  // 복잡한 드래그앤드롭 상태 관리
};

// useMoreRewards 훅 (더보기 효율 전용) 
const useMoreRewards = () => {
  const [selectedRaid, setSelectedRaid] = useState('valtan');
  const [materialCheckedStates, setMaterialCheckedStates] = useState({});
  // 레이드별 재료 상태 관리
};
```

### 4.4 로컬 스토리지 설계

#### 4.4.1 스토리지 키 구조
```javascript
// 캐릭터 검색 히스토리 (페이지별 분리)
'ploa_character_search_history'     // 캐릭터 상세
'ploa_enhancement_search_history'   // 강화 계산기

// 스케줄러 데이터
'scheduler_characters'              // 캐릭터 목록 및 스케줄

// 가격 데이터 (Price Storage System)
'ploa_material_prices'              // 재료 가격 캐시
'ploa_price_update_time'            // 마지막 업데이트 시간
```

#### 4.4.2 데이터 구조 예시
```javascript
// 스케줄러 캐릭터 데이터
{
  id: "unique_id",
  name: "캐릭터명",
  className: "직업명",
  itemLevel: 1620,
  schedule: {
    chaos_dungeon: { completed: false, lastReset: "ISO_DATE" },
    guardian_raid: { completed: false, lastReset: "ISO_DATE" },
    weekly_quest: { completed: 0, lastReset: "ISO_DATE" }
  },
  createdAt: "ISO_DATE",
  updatedAt: "ISO_DATE"
}
```

---

## 🔧 기술 명세서

### 5.1 프론트엔드 기술 스택

#### 5.1.1 핵심 프레임워크
```json
{
  "react": "19.1.0",
  "vite": "5.4.0",
  "tailwindcss": "3.4.17",
  "react-router-dom": "7.6.3"
}
```

#### 5.1.2 UI/UX 라이브러리
```json
{
  "recharts": "3.1.0",           // 차트 라이브러리
  "lucide-react": "0.525.0",     // 아이콘
  "html-react-parser": "5.2.5"   // HTML 파싱
}
```

#### 5.1.3 HTTP 클라이언트
```json
{
  "axios": "1.10.0"              // API 통신
}
```

### 5.2 백엔드/프록시 구조

#### 5.2.1 Express 프록시 서버
```javascript
// proxy-server.js
const express = require('express');
const cors = require('cors');

const app = express();
app.use(cors());

// Lost Ark API 프록시
app.use('/api/lostark', (req, res) => {
  // CORS 처리 및 API 중계
});
```

#### 5.2.2 API 서비스 구조
```javascript
// src/services/lostarkApi.js
const API_BASE_URL = process.env.VITE_LOSTARK_API_URL;
const API_KEY = process.env.VITE_LOSTARK_API_KEY;

export const getCharacterProfile = async (characterName) => {
  const response = await axios.get(`${API_BASE_URL}/armories/characters/${characterName}`, {
    headers: {
      'authorization': `bearer ${API_KEY}`,
      'accept': 'application/json'
    }
  });
  return response.data;
};
```

### 5.3 개발 환경 및 도구

#### 5.3.1 개발 환경
- **OS**: WSL2 Ubuntu
- **Node.js**: v21.7.3
- **npm**: 10.5.0
- **IDE**: VS Code

#### 5.3.2 빌드 도구
```json
{
  "scripts": {
    "dev": "vite",
    "build": "vite build", 
    "preview": "vite preview",
    "lint": "eslint src --ext js,jsx"
  }
}
```

### 5.4 성능 최적화

#### 5.4.1 코드 분할
```javascript
// 동적 import를 통한 lazy loading
const CharacterDetail = lazy(() => import('./pages/CharacterDetail'));
const MarketPrice = lazy(() => import('./pages/MarketPrice'));
```

#### 5.4.2 메모이제이션
```javascript
// React.memo를 활용한 컴포넌트 최적화
const MaterialItem = memo(({ material, onToggleCheck }) => {
  // 컴포넌트 로직
});

// useCallback을 활용한 함수 최적화
const memoizedHandleMaterialToggle = useCallback((gateId, materialName, isChecked) => {
  handleMaterialToggle(gateId, materialName, isChecked);
}, [handleMaterialToggle]);
```

#### 5.4.3 API 캐싱
```javascript
// Price Storage System
export const updatePricesIfNeeded = async (materialNames) => {
  const lastUpdate = localStorage.getItem(PRICE_UPDATE_TIME_KEY);
  const now = new Date();
  
  // 1시간마다 자동 갱신
  if (!lastUpdate || isNewHour()) {
    return await fetchMaterialPrices(materialNames);
  }
  
  return getStoredPrices();
};
```

---

## 🚀 운영 가이드

### 6.1 빌드 및 배포

#### 6.1.1 개발 서버 실행
```bash
# 프론트엔드 개발 서버
cd ploa-frontend
npm run dev        # http://localhost:5173

# 프록시 서버 (필요시)
cd ../
npm start          # http://localhost:3001
```

#### 6.1.2 프로덕션 빌드
```bash
cd ploa-frontend
npm run build      # dist/ 폴더에 빌드 결과 생성
npm run preview    # 빌드 결과 미리보기
```

#### 6.1.3 배포 구성
```bash
# 정적 파일 서빙 (nginx 예시)
server {
    listen 80;
    server_name ploa.example.com;
    
    location / {
        root /var/www/ploa/dist;
        try_files $uri $uri/ /index.html;
    }
    
    location /api/ {
        proxy_pass http://localhost:3001;
    }
}
```

### 6.2 환경 변수 설정

#### 6.2.1 개발 환경 (.env.local)
```bash
VITE_LOSTARK_API_URL=https://developer-lostark.game.onstove.com
VITE_LOSTARK_API_KEY=your_api_key_here
```

#### 6.2.2 프로덕션 환경
```bash
# 환경별 API 엔드포인트 분리
VITE_LOSTARK_API_URL=https://api.ploa.com
VITE_LOSTARK_API_KEY=production_api_key
```

### 6.3 성능 모니터링

#### 6.3.1 API 호출 제한
- **Rate Limit**: 100 requests/minute
- **자동 재시도**: 3회 시도 후 에러 처리
- **캐싱**: 1시간 단위 자동 갱신

#### 6.3.2 에러 핸들링
```javascript
// 전역 에러 바운더리
class ErrorBoundary extends Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }
  
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  
  render() {
    if (this.state.hasError) {
      return <ErrorFallback error={this.state.error} />;
    }
    return this.props.children;
  }
}
```

### 6.4 유지보수 가이드

#### 6.4.1 정기 업데이트 체크리스트
- [ ] Lost Ark API 스펙 변경 확인
- [ ] 게임 패치에 따른 데이터 구조 업데이트
- [ ] 의존성 라이브러리 보안 업데이트
- [ ] 성능 지표 모니터링

#### 6.4.2 디버깅 가이드
```javascript
// 개발 모드 디버깅 정보
if (import.meta.env.DEV) {
  console.log('API Response:', response.data);
  console.log('Parsed Data:', parsedData);
}

// 에러 로깅
const logError = (error, context) => {
  console.error(`[${context}] Error:`, error);
  // 프로덕션에서는 외부 로깅 서비스 연동
};
```

#### 6.4.3 성능 최적화 체크포인트
- Bundle Size Analyzer를 통한 번들 크기 모니터링
- Lighthouse를 통한 성능 점수 측정
- React DevTools Profiler를 통한 렌더링 최적화
- Network 탭을 통한 API 호출 최적화

---

## 📈 향후 개발 계획

### 7.1 단기 계획 (1-2개월)
- OCR 화면 인식 다중 검색 시스템
- 스펙업 우선순위 추천 시스템
- 모바일 UI/UX 최적화
- PWA(Progressive Web App) 지원

### 7.2 중기 계획 (3-6개월)  
- 캐릭터 비교 분석 도구
- 실시간 알림 시스템 (디스코드 연동)
- 데이터 내보내기/가져오기

### 7.3 장기 계획 (6개월 이상)
- 백엔드 서버 구축 (Express → NestJS)
- 사용자 계정 시스템
- 소셜 기능 (길드원 공유, 랭킹)

---

## 📝 결론

PLoa는 로스트아크 유저의 게임 플레이 효율성을 극대화하기 위해 설계된 종합 분석 플랫폼입니다. React 19.1.0 기반의 현대적인 프론트엔드 아키텍처와 18개의 전문 파서 모듈을 통해 복잡한 게임 데이터를 직관적인 인터페이스로 제공합니다.

특히 다음과 같은 기술적 특징을 가집니다:

1. **모듈화된 설계**: 각 기능별로 독립적인 컴포넌트와 훅 구조
2. **효율적인 데이터 처리**: 18개 전문 파서를 통한 정확한 게임 데이터 분석
3. **사용자 중심 설계**: 직관적인 UI/UX와 반응형 디자인
4. **성능 최적화**: 메모이제이션, 코드 분할, 캐싱 시스템
5. **확장 가능한 구조**: 새로운 기능 추가가 용이한 아키텍처

이 설계서를 기반으로 PLoa 프로젝트의 지속적인 발전과 유지보수가 효율적으로 이루어질 수 있을 것입니다.

---